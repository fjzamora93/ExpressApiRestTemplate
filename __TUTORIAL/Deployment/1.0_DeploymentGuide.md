# Deployment

A la hora de crear el despliegue, será necesario modificar los siguientes archivos:

1. app.js -> donde tocaremos las varibles del entorno.
2. Sistemas de pago -> si lo tenemos incorporado, también pasará a las variables del sistema.
3. Creación de nodemon.json: aquí será donde configuremos las variables de entorno en un json
4. Package.json: modificaremos el start server y el start:dev.

Pasos opcionales:
1. Helmet, para mayor seguridad.
2. Compression. Aunque esto lo debería hacer el hosting.
3. Morgan. Para que aparezcan los logs, también lo puede hacer el hosting así que no sería necesario.


### SSL-TLS
Esto es algo que por lo general también se hará a través del hosting, aunque es posible configurarlo manualmente -lo cual no es del todo recomendable.


# Buscar un Hosting Provider

En nuestro caso vamos a trabajar con Heroku, que en lugar de trabajar con una interfaz gráfica de pegar y arrastrar carpeta, funciona con una línea de comandos  propia - que hay que descargar - y que estará vinculada a nuestro Git.


1. Descargamos heroku login 
2. Nos vinculamos a heroku git.
3. Modificamos nuesro package.json y añadimos una línea de código llamada 'engine', ahí detallaremos la versión usada.
4. Crear un procfile: web: node app.js. Esto dejará fuera nuestras variables del entorno.
5. Nos preocupamos de crear el gitignore con lo que no se subirá a guit.

Si seguimos estos pasos y le damos a 'open App' dentro de la web de Heroku, no veremos nada.

Puesto que las variables del entorno no están dentro del heroku, tendremos que configurarlas manualmente.

settings >> config vars >> abajo las vamos escribiendo una a una las variables en parejas de clave-valor.

### Configuración de MongoDB.

Finalmente, tenemos que decirle a MongoDB que añada este servidor a nuestra lista de conexiones permitidas. Esto es un problema, ya que Heroku utiliza una dinámica, por lo que no hay una IP estática, lo que nos obliga a habilitarlas todas - no es la mejor solución.

security >> IPwhiteList >> allow access for anywhere

Si hemos seguido todos estos pasos, ya deberíamos poder ver nuestra App funcionando online.
